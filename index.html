<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NEON CASINO ‚Äî Blackjack ‚Ä¢ War ‚Ä¢ Memory ‚Ä¢ High/Low ‚Ä¢ Poker5 (FX v6+admin)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:#0a0618; --bg2:#120b28; --bg3:#1a1136; --txt:#e6fbff;
      --cyan:#00f0ff; --pink:#ff2d7a; --fuchsia:#d946ef; --violet:#7c3aed; --emerald:#22c55e; --amber:#f59e0b;
      --panel:rgba(255,255,255,0.05);
    }
    body.theme-light{ --bg1:#1c2432; --bg2:#222c3e; --bg3:#2a3650; --txt:#eaf4ff; --panel:rgba(255,255,255,0.07); }

    *{box-sizing:border-box}
    body{
      font-family:"Poppins",system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      background:
        radial-gradient(1200px 800px at 20% 0%, var(--bg3), transparent 60%),
        radial-gradient(1400px 900px at 80% 0%, #250e4b 0%, transparent 60%),
        linear-gradient(180deg,var(--bg2),var(--bg1));
      color:var(--txt); overflow-x:hidden; transition:background .35s ease,color .25s ease
    }

    .glass{background:var(--panel); border:1px solid rgba(255,255,255,.08); border-radius:18px; box-shadow:0 8px 30px rgba(0,0,0,.5), inset 0 1px 0 rgba(255,255,255,.04); backdrop-filter: blur(6px)}
    body.theme-light .glass{border-color:rgba(0,0,0,.08); box-shadow:0 6px 22px rgba(0,0,0,.28)}

    .frame{position:relative; background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03)); border-radius:26px; border:1px solid rgba(0,255,255,.18); box-shadow:inset 0 0 0 1px rgba(255,255,255,.06), 0 40px 100px rgba(0,0,0,.6)}
    .frame::before{ content:""; position:absolute; inset:-2px; border-radius:inherit; background:conic-gradient(from 120deg, rgba(0,240,255,.35), rgba(124,58,237,.28), rgba(255,45,122,.33), rgba(0,240,255,.35)); filter:blur(24px); opacity:.55; z-index:-1; animation:spin 16s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    .btn{border-radius:14px; font-weight:800; letter-spacing:.4px; box-shadow:0 10px 30px rgba(0,0,0,.25); transition: transform .15s ease, filter .15s ease, box-shadow .2s}
    .btn:hover{transform:translateY(-2px); filter:brightness(1.06)}
    .btn:active{transform:translateY(0) scale(.98)}
    .btn-primary{background:linear-gradient(180deg, rgba(0,240,255,.18), rgba(0,240,255,.07)); border:2px solid rgba(0,240,255,.85); color:#02343b}
    .btn-hit{background:linear-gradient(180deg,#13c6e5,#06b6d4); color:#ffffff; border:2px solid rgba(6,182,212,.9)}
    .btn-stand{background:linear-gradient(180deg,#f472b6,#ec4899); color:#ffffff; border:2px solid rgba(236,72,153,.9)}
    .btn-deal{background:linear-gradient(180deg,#60a5fa,#22d3ee); color:#ffffff; border:2px solid rgba(34,211,238,.9)}
    .btn-reset{background:linear-gradient(180deg,#ef4444,#b91c1c); color:#ffffff; border:2px solid rgba(185,28,28,.95)}
    .btn-muted{background:linear-gradient(180deg,#94a3b8,#64748b); color:#0b1220; border:2px solid rgba(100,116,139,.95)}

    .btn-hit:hover{box-shadow:0 18px 40px rgba(6,182,212,.35)}
    .btn-stand:hover{box-shadow:0 18px 40px rgba(236,72,153,.35)}
    .btn-deal:hover{box-shadow:0 18px 44px rgba(34,211,238,.35)}
    .btn-reset:hover{box-shadow:0 18px 44px rgba(239,68,68,.35)}

    .chip{width:68px; height:68px; border-radius:9999px; background:radial-gradient(circle at 30% 30%, #ff9ec3, #ff377f 45%, #c30b52 70%); border:4px dashed rgba(255,255,255,.35); display:flex; align-items:center; justify-content:center; font-weight:900; color:#ffe8f1; filter:drop-shadow(0 10px 30px rgba(255,45,122,.35)); transition: transform .15s ease, filter .15s ease}
    .chip:hover{transform:translateY(-4px) scale(1.04); filter:drop-shadow(0 16px 44px rgba(255,45,122,.55))}

    .p-card{width:96px; height:136px; border-radius:14px; background:#f6fbff; border:3px solid var(--cyan); box-shadow:0 18px 50px rgba(0,240,255,.22); display:flex; flex-direction:column; justify-content:space-between; padding:10px; transform:translateZ(0); transition: transform .18s, box-shadow .18s}
    .p-card.pink{border-color:var(--pink); box-shadow:0 18px 50px rgba(255,45,122,.22)}
    .p-card:hover{transform:translateY(-4px) rotate(-1deg); box-shadow:0 30px 70px rgba(0,240,255,.28)}
    .p-suit{font-size:22px}
    .p-rank{font-size:22px; font-weight:800}

    .card-back{width:96px; height:136px; border-radius:14px; border:2px dashed rgba(0,240,255,.45); background:rgba(255,255,255,.04); display:grid; place-items:center; color:#7dd3fc}
    .deal-in{animation:dealIn .45s cubic-bezier(.2,.8,.2,1)}
    @keyframes dealIn{0%{transform:translateY(-40px) scale(.7); opacity:0} 70%{transform:translateY(6px) scale(1.05); opacity:1} 100%{transform:translateY(0) scale(1)} }

    .card3d{width:96px; height:136px; perspective:900px}
    .card3d .inner{position:relative; width:100%; height:100%; transform-style:preserve-3d; transition:transform .35s ease; transform:rotateY(180deg)}
    .card3d.flipped .inner{transform:rotateY(0deg)}
    .side{position:absolute; inset:0; backface-visibility:hidden; border-radius:14px; overflow:hidden}
    .side.front{background:#f6fbff; border:3px solid var(--cyan); display:flex; flex-direction:column; justify-content:space-between; padding:10px}
    .side.back{transform:rotateY(180deg); display:grid; place-items:center; border:2px dashed rgba(0,240,255,.45); background:rgba(255,255,255,.06); color:#7dd3fc}

    .overlay{pointer-events:none; position:fixed; inset:0; display:none; align-items:center; justify-content:center}
    .overlay.show{display:flex}
    .overlay .back{position:absolute; inset:0; backdrop-filter: blur(6px)}
    .win .back{background:radial-gradient(60% 60% at 50% 50%, rgba(34,197,94,.25), rgba(0,0,0,.55))}
    .lose .back{background:radial-gradient(60% 60% at 50% 50%, rgba(255,51,85,.25), rgba(0,0,0,.6))}
    .push .back{background:radial-gradient(60% 60% at 50% 50%, rgba(0,240,255,.18), rgba(0,0,0,.55))}
    .titleFX{font-weight:900; letter-spacing:.12em; -webkit-text-stroke: 2px rgba(255,255,255,.15); text-shadow:0 0 14px rgba(0,240,255,.35), 0 0 50px rgba(124,58,237,.25)}

    .confetti{position:fixed; width:10px; height:10px; border-radius:2px; animation:fall 1100ms cubic-bezier(.2,.8,.2,1) forwards}
    @keyframes fall{0%{transform:translateY(-20px) rotate(0)} 100%{transform:translateY(260px) rotate(540deg); opacity:0}}

    .shake{animation:shake .5s cubic-bezier(.36,.07,.19,.97)}
    @keyframes shake{10%,90%{transform:translateX(-1px)} 20%,80%{transform:translateX(2px)} 30%,50%,70%{transform:translateX(-4px)} 40%,60%{transform:translateX(4px)}}
    .pulse{animation:pulse 900ms ease}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(0,240,255,.6)} 100%{box-shadow:0 0 0 26px rgba(0,240,255,0)}}

    .parallax{transform:perspective(1000px) rotateX(var(--rx,0deg)) rotateY(var(--ry,0deg)); transition: transform .08s}

    @media (max-width:1200px){ .layout{grid-template-columns: 320px 1fr} }
    @media (max-width:900px){ .layout{grid-template-columns:1fr; gap:14px} .right{order:3} .center{order:2} .left{order:1} }

    /* Secret admin button */
    #adminBtn{position:absolute; left:10px; top:8px; opacity:.65; transition:transform .15s, opacity .15s}
    #adminBtn:hover{opacity:1; transform:scale(1.08)}
  </style>
</head>
<body>
  <!-- Header now relative for absolute admin button -->
  <header class="relative max-w-7xl mx-auto px-6 pt-7 pb-4 flex items-center justify-between">
    <!-- üîê Secret Admin Button -->
    <button id="adminBtn" class="text-cyan-200 text-2xl" title="Admin Access">üí∞</button>

    <div class="flex items-center gap-3">
      <div class="w-12 h-12 rounded-2xl" style="background:conic-gradient(from 90deg,var(--violet),var(--fuchsia),var(--pink),var(--cyan)); box-shadow:0 10px 30px rgba(0,240,255,.25)"></div>
      <div>
        <h1 class="text-4xl md:text-5xl font-extrabold tracking-[0.2em] text-cyan-200 drop-shadow">NEON CASINO</h1>
        <p class="text-cyan-300/70 text-xs md:text-sm tracking-[0.2em]">WELCOME TO THE FUTURE OF CARDS</p>
      </div>
    </div>
    <div class="flex items-center gap-3">
      <button id="soundBtn" class="btn btn-muted px-3 py-2 text-sm" title="Toggle sound">üîä Sound</button>
      <button id="themeBtn" class="btn btn-primary px-4 py-2 text-sm" title="Toggle light/dark">‚òÄÔ∏è Light</button>
      <select id="lang" class="glass px-3 py-2 rounded-xl text-sm text-cyan-200 border border-cyan-300/30 bg-white/5">
        <option value="en">EN</option>
        <option value="uk">UK</option>
        <option value="ru">RU</option>
      </select>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-6 pb-12 grid layout grid-cols-[320px_1fr_320px] gap-6">
    <!-- LEFT -->
    <aside class="left flex flex-col gap-6">
      <section class="glass p-4">
        <h3 class="text-cyan-200 font-extrabold tracking-widest text-sm mb-3" data-i18n="selectGame">SELECT GAME</h3>
        <div class="flex flex-col gap-3">
          <button class="group game-btn w-full flex items-center gap-3 justify-between px-4 py-3 rounded-xl border border-cyan-300/20 bg-white/5 hover:bg-white/10" data-game="blackjack" id="btnBlackjack">
            <div class="flex items-center gap-3">
              <span class="w-8 h-8 rounded-lg bg-fuchsia-400/20 grid place-items-center text-fuchsia-200">üÉè</span>
              <span class="font-semibold">Blackjack</span>
            </div>
            <span class="statusDot hidden sm:inline text-xs text-cyan-300">‚óè</span>
          </button>

          <button class="group game-btn w-full flex items-center gap-3 justify-between px-4 py-3 rounded-xl border border-cyan-300/20 bg-white/5 hover:bg-white/10" data-game="war" id="btnWar">
            <div class="flex items-center gap-3">
              <span class="w-8 h-8 rounded-lg bg-fuchsia-400/20 grid place-items-center text-fuchsia-200">‚öîÔ∏è</span>
              <span class="font-semibold">War</span>
            </div>
            <span class="statusDot hidden sm:inline text-xs text-cyan-300">‚óè</span>
          </button>

          <!-- NEW PREVIEW: High/Low SVG -->
          <button class="group game-btn w-full flex items-center gap-3 justify-between px-4 py-3 rounded-xl border border-cyan-300/20 bg-white/5 hover:bg-white/10" data-game="highlow" id="btnHighLow">
            <div class="flex items-center gap-3">
              <span class="w-8 h-8 rounded-lg bg-cyan-400/20 grid place-items-center">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <path d="M7 16l5-5 5 5" stroke="#22d3ee" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M7 8h10" stroke="#a78bfa" stroke-width="2" stroke-linecap="round"/>
                </svg>
              </span>
              <span class="font-semibold">High / Low</span>
            </div>
            <span class="statusDot hidden sm:inline text-xs text-cyan-300">‚óè</span>
          </button>

          <!-- NEW PREVIEW: Poker 5-Draw SVG -->
          <button class="group game-btn w-full flex items-center gap-3 justify-between px-4 py-3 rounded-xl border border-cyan-300/20 bg-white/5 hover:bg-white/10" data-game="poker5" id="btnPoker5">
            <div class="flex items-center gap-3">
              <span class="w-8 h-8 rounded-lg bg-violet-400/20 grid place-items-center">
                <svg width="22" height="22" viewBox="0 0 48 48" fill="none" aria-hidden="true">
                  <rect x="8" y="10" rx="3" ry="3" width="20" height="28" fill="#f6fbff" stroke="#22d3ee" stroke-width="2"/>
                  <rect x="16" y="6" rx="3" ry="3" width="20" height="28" fill="#fff0fb" stroke="#ec4899" stroke-width="2"/>
                  <text x="26" y="23" text-anchor="middle" font-size="10" font-weight="700" fill="#0ea5a4">5</text>
                </svg>
              </span>
              <span class="font-semibold">Poker 5-Draw</span>
            </div>
            <span class="statusDot hidden sm:inline text-xs text-cyan-300">‚óè</span>
          </button>

          <button class="group game-btn w-full flex items-center gap-3 justify-between px-4 py-3 rounded-xl border border-cyan-300/20 bg-white/5 hover:bg-white/10" data-game="memory" id="btnMemory">
            <div class="flex items-center gap-3">
              <span class="w-8 h-8 rounded-lg bg-fuchsia-400/20 grid place-items-center text-fuchsia-200">üß†</span>
              <span class="font-semibold">Memory</span>
            </div>
            <span class="statusDot hidden sm:inline text-xs text-cyan-300">‚óè</span>
          </button>
        </div>
      </section>

      <section class="glass p-5">
        <div class="text-cyan-200 font-extrabold tracking-widest text-sm" data-i18n="balance">BALANCE</div>
        <div id="balance" class="text-3xl font-extrabold text-emerald-400 drop-shadow mt-1">$1000.00</div>

        <div class="mt-5 text-cyan-200 font-extrabold tracking-widest text-sm" data-i18n="currentBet">CURRENT BET</div>
        <div id="betLabel" class="text-2xl font-extrabold text-cyan-300 mt-1">$10.00</div>

        <!-- Raise/lower controls -->
        <div class="mt-3 flex items-center gap-2">
          <button id="betMinus" class="btn btn-stand px-3 py-2" title="Decrease bet">‚àí</button>
          <input id="betInput" type="number" min="1" max="100000" step="1"
                 class="glass w-28 px-3 py-2 rounded-xl text-cyan-100 bg-white/5 border border-cyan-300/20"
                 value="10"/>
          <button id="betPlus" class="btn btn-hit px-3 py-2" title="Increase bet">+</button>
        </div>
        <div class="text-xs text-cyan-300/70 mt-1">Shift = √ó10 ‚Ä¢ Ctrl = √ó50 ‚Ä¢ Scroll = ¬±</div>

        <div class="mt-5 text-cyan-200 font-extrabold tracking-widest text-sm" data-i18n="selectChip">SELECT CHIP</div>
        <div class="mt-3 grid grid-cols-3 gap-4">
          <button class="chip" data-chip="5">$5</button>
          <button class="chip" data-chip="10">$10</button>
          <button class="chip" data-chip="25">$25</button>
          <button class="chip" data-chip="50">$50</button>
          <button class="chip" data-chip="100">$100</button>
          <button class="chip" data-chip="500">$500</button>
        </div>
      </section>

      <section class="glass p-5">
        <div class="text-cyan-200 font-extrabold tracking-widest text-sm" data-i18n="streak">WIN STREAK</div>
        <div class="mt-2 flex items-center gap-2 text-pink-300 text-xl"><span>üî•</span><span id="streak">x0</span></div>
      </section>

      <section class="glass p-4"><button id="reset" class="w-full btn btn-reset px-4 py-3 text-lg" data-i18n="reset">RESET GAME</button></section>
    </aside>

    <!-- CENTER -->
    <section class="center relative">
      <div id="table" class="frame p-6 md:p-10 min-h-[720px] parallax">
        <div class="flex items-center justify-between">
          <h2 id="titleGame" class="text-3xl md:text-4xl font-extrabold tracking-[.25em] text-cyan-200">BLACKJACK</h2>
          <label class="flex items-center gap-2 text-cyan-200/80 text-sm select-none">
            <input id="soft17" type="checkbox" class="scale-110" checked/>
            <span data-i18n="soft17">Dealer stands on soft 17</span>
          </label>
        </div>
        <div class="mt-6 grid gap-6">
          <div class="text-center text-cyan-300/90 tracking-widest" id="dealerLabel" data-i18n="dealer">DEALER</div>
          <div id="dealerArea" class="flex flex-wrap gap-4 justify-center"></div>
          <div class="text-center text-cyan-300/90 tracking-widest" id="youLabel" data-i18n="you">YOU</div>
          <div id="playerArea" class="flex flex-wrap gap-4 justify-center"></div>
          <div id="memoryGrid" class="grid grid-cols-4 gap-4 justify-items-center hidden"></div>
        </div>
        <div id="toast" class="mt-6 w-full text-center glass px-4 py-4 rounded-xl text-emerald-300 font-semibold">Place your bet and deal!</div>
        <div class="mt-6 flex flex-wrap gap-3 justify-center">
          <button id="action" class="btn btn-deal px-8 py-3 text-lg">DEAL ($10)</button>
          <button id="hit" class="btn btn-hit px-5 py-3">HIT (H)</button>
          <button id="stand" class="btn btn-stand px-5 py-3">STAND (S)</button>
          <!-- High/Low controls -->
          <button id="higher" class="btn btn-hit px-5 py-3 hidden">HIGHER</button>
          <button id="lower" class="btn btn-stand px-5 py-3 hidden">LOWER</button>
          <!-- Poker controls -->
          <button id="pokerDeal" class="btn btn-deal px-5 py-3 hidden">DEAL</button>
          <button id="pokerDraw" class="btn btn-hit px-5 py-3 hidden">DRAW</button>
        </div>
      </div>

      <!-- Outcome overlay -->
      <div id="overlay" class="overlay">
        <div class="back"></div>
        <div class="relative text-center">
          <div id="overlayTitle" class="text-6xl md:text-8xl titleFX">YOU WIN!</div>
          <div id="delta" class="mt-2 text-3xl font-extrabold">+$20</div>
        </div>
      </div>
    </section>

    <!-- RIGHT -->
    <aside class="right flex flex-col gap-6">
      <section class="glass p-5">
        <h3 class="text-cyan-200 font-extrabold tracking-widest text-sm" data-i18n="how">HOW TO PLAY</h3>
        <ul class="mt-3 text-sm text-cyan-100/90 leading-7" id="rulesList">
          <li><b>Goal:</b> <span data-i18n="howGoal">Get closer to 21 than the dealer without going over.</span></li>
          <li><b>Hit:</b> <span data-i18n="howHit">Take another card</span></li>
          <li><b>Stand:</b> <span data-i18n="howStand">Keep your current hand</span></li>
          <li class="text-cyan-300/80" data-i18n="howFaces">Face cards = 10, Aces = 1 or 11</li>
        </ul>
      </section>
      <section class="glass p-5">
        <h3 class="text-cyan-200 font-extrabold tracking-widest text-sm" data-i18n="tips">TIPS</h3>
        <ul class="mt-3 text-sm text-cyan-100/90 leading-7 list-disc list-inside">
          <li data-i18n="t1">Start with smaller bets to learn</li>
          <li data-i18n="t2">Watch your balance carefully</li>
          <li data-i18n="t3">Each game has different odds</li>
          <li data-i18n="t4">Have fun and play responsibly!</li>
        </ul>
      </section>
      <section class="glass p-5">
        <h3 class="text-cyan-200 font-extrabold tracking-widest text-sm">ABOUT</h3>
        <p class="text-sm text-cyan-100/90">Neon Casino ‚Äî A futuristic card game experience</p>
        <div class="text-xs text-cyan-300/70 mt-2">v1.4 FX v6</div>
      </section>
    </aside>
  </main>

  <!-- üîê ADMIN MODAL -->
  <div id="adminModal" class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center hidden z-50">
    <div class="glass p-6 rounded-2xl w-[320px] text-center relative">
      <h3 class="text-cyan-200 font-extrabold text-lg mb-4">ADMIN PANEL</h3>
      <input id="adminPass" type="password" placeholder="Enter password"
             class="w-full mb-4 px-3 py-2 rounded-lg border border-cyan-400/30 bg-white/10 text-cyan-100 text-center focus:outline-none">
      <input id="adminAmount" type="number" placeholder="Amount $" disabled
             class="w-full mb-4 px-3 py-2 rounded-lg border border-cyan-400/30 bg-white/10 text-cyan-100 text-center focus:outline-none">
      <button id="adminAdd" class="btn btn-hit w-full py-2 mb-2 disabled:opacity-40" disabled>ADD FUNDS</button>
      <button id="adminClose" class="btn btn-reset w-full py-2">CLOSE</button>
    </div>
  </div>

  <script>
    // ===== i18n =====
    const I18N={
      en:{selectGame:'SELECT GAME', balance:'BALANCE', currentBet:'CURRENT BET', selectChip:'SELECT CHIP', streak:'WIN STREAK', reset:'Reset Game', soft17:'Dealer stands on soft 17', dealer:'DEALER', you:'YOU', how:'HOW TO PLAY', howGoal:'Get closer to 21 than the dealer without going over.', howHit:'Take another card', howStand:'Keep your current hand', howFaces:'Face cards = 10, Aces = 1 or 11', tips:'TIPS', t1:'Start with smaller bets to learn', t2:'Watch your balance carefully', t3:'Each game has different odds', t4:'Have fun and play responsibly!'},
      uk:{selectGame:'–û–ë–ï–†–Ü–¢–¨ –ì–†–£', balance:'–ë–ê–õ–ê–ù–°', currentBet:'–ü–û–¢–û–ß–ù–ê –°–¢–ê–í–ö–ê', selectChip:'–û–ë–ï–†–Ü–¢–¨ –§–Ü–®–ö–£', streak:'–°–ï–†–Ü–Ø –ü–ï–†–ï–ú–û–ì', reset:'–°–∫–∏–Ω—É—Ç–∏ –≥—Ä—É', soft17:'–î–∏–ª–µ—Ä —Å—Ç–æ—ó—Ç—å –Ω–∞ soft 17', dealer:'–î–ò–õ–ï–†', you:'–í–ò', how:'–Ø–ö –ì–†–ê–¢–ò', howGoal:'–ù–∞–±–µ—Ä—ñ—Ç—å –±—ñ–ª—å—à–µ –∑–∞ –¥–∏–ª–µ—Ä–∞, –Ω–µ –ø–µ—Ä–µ–≤–∏—â–∏–≤—à–∏ 21.', howHit:'–í–∑—è—Ç–∏ —â–µ –∫–∞—Ä—Ç—É', howStand:'–ó–∞–ª–∏—à–∏—Ç–∏—Å—å', howFaces:'–ö–∞—Ä—Ç–∏–Ω–∫–∏ = 10, –¢—É–∑ = 1 –∞–±–æ 11', tips:'–ü–û–†–ê–î–ò', t1:'–ü–æ—á–∏–Ω–∞–π—Ç–µ –∑ –º–∞–ª–∏—Ö —Å—Ç–∞–≤–æ–∫', t2:'–°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ –±–∞–ª–∞–Ω—Å–æ–º', t3:'–£ —Ä—ñ–∑–Ω–∏—Ö —ñ–≥–æ—Ä —Ä—ñ–∑–Ω—ñ —à–∞–Ω—Å–∏', t4:'–ì—Ä–∞–π—Ç–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ!'},
      ru:{selectGame:'–í–´–ë–ï–†–ò–¢–ï –ò–ì–†–£', balance:'–ë–ê–õ–ê–ù–°', currentBet:'–¢–ï–ö–£–©–ê–Ø –°–¢–ê–í–ö–ê', selectChip:'–í–´–ë–ï–†–ò–¢–ï –§–ò–®–ö–£', streak:'–°–ï–†–ò–Ø –ü–û–ë–ï–î', reset:'–°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É', soft17:'–î–∏–ª–µ—Ä —Å—Ç–æ–∏—Ç –Ω–∞ soft 17', dealer:'–î–ò–õ–ï–†', you:'–í–´', how:'–ö–ê–ö –ò–ì–†–ê–¢–¨', howGoal:'–ù–∞–±–µ—Ä–∏—Ç–µ –±–æ–ª—å—à–µ –¥–∏–ª–µ—Ä–∞, –Ω–µ –ø—Ä–µ–≤—ã—Å–∏–≤ 21.', howHit:'–í–∑—è—Ç—å –µ—â—ë –∫–∞—Ä—Ç—É', howStand:'–û—Å—Ç–∞—Ç—å—Å—è', howFaces:'–ö–∞—Ä—Ç–∏–Ω–∫–∏ = 10, –¢—É–∑ = 1 –∏–ª–∏ 11', tips:'–°–û–í–ï–¢–´', t1:'–ù–∞—á–∏–Ω–∞–π—Ç–µ —Å –º–∞–ª–µ–Ω—å–∫–∏—Ö —Å—Ç–∞–≤–æ–∫', t2:'–°–ª–µ–¥–∏—Ç–µ –∑–∞ –±–∞–ª–∞–Ω—Å–æ–º', t3:'–£ —Ä–∞–∑–Ω—ã—Ö –∏–≥—Ä —Ä–∞–∑–Ω—ã–µ —à–∞–Ω—Å—ã', t4:'–ò–≥—Ä–∞–π—Ç–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ!'}
    }
    const applyI18n=(lang)=>{const d=I18N[lang]||I18N.en;document.querySelectorAll('[data-i18n]').forEach(n=>{const k=n.dataset.i18n;if(d[k]) n.textContent=d[k];});}

    // ===== Sound Engine (WebAudio) =====
    const Sound=(()=>{
      let ctx; let muted=false;
      const ensure=()=>{ if(!ctx){ const AC=window.AudioContext||window.webkitAudioContext; ctx=new AC(); } };
      const now=()=> ctx.currentTime;
      function beep({freq=440, dur=.08, type='sine', vol=.2, attack=0.005, release=0.08}){
        if(muted) return;
        ensure();
        const t=now();
        const o=ctx.createOscillator(); const g=ctx.createGain();
        o.type=type; o.frequency.value=freq;
        g.gain.setValueAtTime(0,t);
        g.gain.linearRampToValueAtTime(vol, t+attack);
        g.gain.exponentialRampToValueAtTime(0.0001, t+attack+dur+release);
        o.connect(g); g.connect(ctx.destination); o.start(t); o.stop(t+attack+dur+release);
      }
      const seq=(arr)=>{ let base=0; arr.forEach(s=>{ setTimeout(()=>beep(s), base*1000); base+= (s.delay ?? s.dur ?? .1); }); }
      return {
        toggle(){ muted=!muted; return !muted; },
        click(){ beep({freq:600,dur:.04,type:'square',vol:.15}); },
        deal(){ beep({freq:420,dur:.05,type:'triangle',vol:.18}); },
        flip(){ beep({freq:760,dur:.04,type:'square',vol:.14}); },
        hit(){ beep({freq:520,dur:.07,type:'triangle',vol:.18}); },
        stand(){ beep({freq:340,dur:.07,type:'sine',vol:.16}); },
        win(){ seq([{freq:740,dur:.07,type:'square'},{freq:880,dur:.07,type:'square'},{freq:1040,dur:.09,type:'square'}]); },
        lose(){ seq([{freq:220,dur:.12,type:'sine'},{freq:180,dur:.14,type:'sine'}]); },
        push(){ seq([{freq:500,dur:.06,type:'triangle'},{freq:500,dur:.06,type:'triangle'}]); },
        bet(){ beep({freq:900,dur:.04,type:'square',vol:.16}); }
      }
    })();

    // ===== State & DOM =====
    const state={game:'blackjack', balance:1000, bet:10, streak:0, soft17:true, theme:'dark', sound:true};
    const SUITS=['‚ô†','‚ô•','‚ô¶','‚ô£']; const RANKS=['A','2','3','4','5','6','7','8','9','10','J','Q','K'];
    let deck=[], dealer=[], player=[], inRound=false;
    let memory={cards:[], flipped:[], matched:new Set(), lock:false, pairs:8, elems:[]};
    let highlow={current:null, next:null, reveal:false};
    let poker={stage:'idle', holds:[false,false,false,false,false]};

    const qs=s=>document.querySelector(s);
    const langSel=qs('#lang'); const table=qs('#table'); const dealerArea=qs('#dealerArea'); const playerArea=qs('#playerArea'); const grid=qs('#memoryGrid');
    const actionBtn=qs('#action'); const toast=qs('#toast'); const titleGame=qs('#titleGame'); const soft17El=qs('#soft17');
    const balanceEl=qs('#balance'); const betLabel=qs('#betLabel'); const overlay=qs('#overlay'); const overlayTitle=qs('#overlayTitle'); const delta=qs('#delta'); const streakEl=qs('#streak');
    const themeBtn=qs('#themeBtn'); const soundBtn=qs('#soundBtn'); const dealerLabel=qs('#dealerLabel'); const youLabel=qs('#youLabel');
    const higherBtn=qs('#higher'); const lowerBtn=qs('#lower'); const pokerDealBtn=qs('#pokerDeal'); const pokerDrawBtn=qs('#pokerDraw');
    const betMinus=qs('#betMinus'); const betPlus=qs('#betPlus'); const betInput=qs('#betInput');

    // Admin DOM
    const adminBtn=qs('#adminBtn');
    const adminModal=qs('#adminModal');
    const adminPass=qs('#adminPass');
    const adminAmount=qs('#adminAmount');
    const adminAdd=qs('#adminAdd');
    const adminClose=qs('#adminClose');

    const save=()=> localStorage.setItem('neonCasino', JSON.stringify(state));
    const load=()=>{try{Object.assign(state, JSON.parse(localStorage.getItem('neonCasino')||'{}'));}catch{}}
    function ensureBalance(){ if(!Number.isFinite(state.balance) || state.balance<=0){ state.balance=1000; toast.textContent='Balance refilled to $1000'; } }

    function newDeck(){const d=[];for(const s of SUITS){for(const r of RANKS){d.push({s,r});}}for(let i=d.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[d[i],d[j]]=[d[j],d[i]];}return d}
    const valRank=r=> r==='A'?14 : r==='K'?13 : r==='Q'?12 : r==='J'?11 : Number(r);
    const bjVal=r=> r==='A'?11 : ['K','Q','J'].includes(r)?10 : Number(r);
    function totals(hand){let sums=[0];for(const c of hand){const vals=c.r==='A'?[1,11]:[bjVal(c.r)];const next=[];for(const s of sums){for(const v of vals) next.push(s+v);}sums=[...new Set(next)];}const under=sums.filter(x=>x<=21);return under.length?under.sort((a,b)=>b-a):[Math.min(...sums)]}
    const best=h=> totals(h)[0]; const isBJ=h=> h.length===2 && totals(h).includes(21);

    function cardEl(c){const el=document.createElement('div');const isRed=(c.s==='‚ô•'||c.s==='‚ô¶');el.className='p-card deal-in '+(isRed?'pink':'');el.innerHTML=`<div class="flex justify-between"><span class="p-rank ${isRed?'text-pink-500':'text-cyan-600'}">${c.r}</span><span class="p-suit ${isRed?'text-pink-500':'text-cyan-600'}">${c.s}</span></div><div class="text-center text-3xl ${isRed?'text-pink-500':'text-cyan-600'} opacity-80">${c.s}</div><div class="text-right p-rank ${isRed?'text-pink-500':'text-cyan-600'}">${c.r}</div>`;return el}
    function backEl(){const b=document.createElement('div'); b.className='card-back deal-in'; b.textContent='?'; return b}

    function showControls(){
      [actionBtn, qs('#hit'), qs('#stand'), higherBtn, lowerBtn, pokerDealBtn, pokerDrawBtn].forEach(b=>b.classList.add('hidden'));
      if(state.game==='blackjack'){ actionBtn.classList.remove('hidden'); qs('#hit').classList.remove('hidden'); qs('#stand').classList.remove('hidden'); }
      if(state.game==='war'){ actionBtn.classList.remove('hidden'); }
      if(state.game==='memory'){ actionBtn.classList.remove('hidden'); actionBtn.textContent='START / RESTART'; }
      if(state.game==='highlow'){ higherBtn.classList.remove('hidden'); lowerBtn.classList.remove('hidden'); actionBtn.classList.remove('hidden'); actionBtn.textContent = highlow.current? 'NEXT ROUND' : `DEAL ($${state.bet})`; }
      if(state.game==='poker5'){ poker.stage==='idle' ? pokerDealBtn.classList.remove('hidden') : pokerDrawBtn.classList.remove('hidden'); }
    }

    function setBet(v){
      const min=1, max=100000;
      const val=Math.max(min, Math.min(max, Math.round(Number(v)||state.bet)));
      if (val!==state.bet) { state.bet=val; betLabel.textContent=`$${state.bet.toFixed(2)}`; betInput.value=String(state.bet); Sound.bet(); save(); actionBtn.textContent = actionBtn.textContent.replace(/\(\$\d+\)/, `($${state.bet})`); }
    }

    function render(){
      balanceEl.textContent=`$${state.balance.toFixed(2)}`;
      betLabel.textContent=`$${state.bet.toFixed(2)}`; betInput.value=String(state.bet);
      streakEl.textContent='x'+state.streak; titleGame.textContent=state.game.toUpperCase(); soft17El.checked=!!state.soft17;

      if(state.game==='blackjack'){ dealerLabel.textContent = (I18N[langSel.value]||I18N.en).dealer + ` (${best(dealer)||0})`; youLabel.textContent = (I18N[langSel.value]||I18N.en).you + ` (${best(player)||0})`; }
      else if(state.game==='highlow'){ dealerLabel.textContent = 'CURRENT'; youLabel.textContent = 'NEXT'; }
      else { dealerLabel.textContent = (I18N[langSel.value]||I18N.en).dealer; youLabel.textContent = (I18N[langSel.value]||I18N.en).you; }

      dealerArea.innerHTML=''; playerArea.innerHTML=''; grid.classList.add('hidden');
      if(state.game==='memory'){ grid.classList.remove('hidden'); renderMemory(); }
      else if(state.game==='highlow'){
        if(highlow.current) dealerArea.appendChild(cardEl(highlow.current)); else dealerArea.appendChild(backEl());
        if(highlow.next && highlow.reveal) playerArea.appendChild(cardEl(highlow.next)); else playerArea.appendChild(backEl());
      }
      else { dealer.forEach(c=>dealerArea.appendChild(cardEl(c))); player.forEach(c=>playerArea.appendChild(cardEl(c))); }

      // Rules (–∫–æ—Ä–æ—Ç–∫–æ)
      const rules=qs('#rulesList');
      if(state.game==='blackjack'){
        rules.innerHTML = `<li><b>Goal:</b> Get closer to 21 than the dealer without busting.</li><li><b>Hit:</b> Take another card</li><li><b>Stand:</b> Keep your hand; dealer draws to 17</li><li>Blackjack pays 3:2</li>`;
      } else if(state.game==='war'){
        rules.innerHTML = `<li>Both sides draw one card</li><li>Higher rank wins (A high)</li><li>Tie = push</li>`;
      } else if(state.game==='memory'){
        rules.innerHTML = `<li>Flip two cards to find a pair</li><li>Match all pairs to win +$50</li>`;
      } else if(state.game==='highlow'){
        rules.innerHTML = `<li>Guess if the <b>next</b> card will be <b>Higher</b> or <b>Lower</b> than the current</li><li>Win = +$bet, Lose = -$bet, Tie = push</li>`;
      } else if(state.game==='poker5'){
        rules.innerHTML = `<li>Deal 5 ‚Üí click cards to <b>Hold</b>, then <b>Draw</b></li><li>Payouts: JOB(1x), 2P(2x), Trips(3x), Straight(4x), Flush(6x), Full(9x), Quads(25x), SF(50x), Royal(250x)</li>`;
      }

      save(); showControls();
    }

    function setGame(g){
      state.game=g;
      document.querySelectorAll('.game-btn').forEach(b=>{
        b.classList.toggle('ring-2', b.dataset.game===g);
        b.classList.toggle('ring-cyan-400/70', b.dataset.game===g);
        const dot=b.querySelector('.statusDot'); if(dot) dot.classList.toggle('hidden', b.dataset.game!==g);
      });
      dealer=[]; player=[]; inRound=false;
      highlow={current:null,next:null,reveal:false};
      poker={stage:'idle', holds:[false,false,false,false,false]};
      toast.textContent=(g==='blackjack')?'Place your bet and deal!':(g==='war'?'Draw cards to start!':(g==='highlow'?'Deal to start, then pick Higher/Lower':(g==='poker5'?'Deal 5, hold, then draw':'Flip and match pairs!')));
      if(g==='memory') startMemory();
      render();
    }

    // ---- Blackjack ----
    function dealBlackjack(){ if(inRound) return; ensureBalance(); if(state.balance<state.bet){ toast.textContent='Not enough balance'; return;}
      inRound=true; dealer=[]; player=[]; if(deck.length<15) deck=newDeck(); state.balance-=state.bet; render();
      player.push(deck.pop(), deck.pop()); dealer.push(deck.pop(), deck.pop()); render(); toast.textContent='Good luck!'; Sound.deal();
      if(isBJ(player)||isBJ(dealer)) resolveBJ();
    }
    function hit(){ if(!inRound||state.game!=='blackjack') return; if(best(player)>=21) return; player.push(deck.pop()); render(); Sound.hit(); if(best(player)>21) resolveBJ(); }
    function stand(){ if(!inRound||state.game!=='blackjack') return;
      while(true){
        const t=totals(dealer); const b=t[0]; const soft17Now=t.includes(17)&&t.some(x=>x!==17);
        if(b<17) dealer.push(deck.pop());
        else if(soft17Now && !state.soft17) dealer.push(deck.pop());
        else break;
      }
      render(); Sound.stand(); resolveBJ();
    }
    function showOverlay(title, dText, type){
      overlayTitle.textContent=title; delta.textContent=dText; overlay.className='overlay show '+type;
      const colors= type==='win' ? ['#22d3ee','#a78bfa','#fb7185','#fbbf24','#34d399'] : (type==='lose'? ['#ff8aa0','#ff3355','#ffa8b6'] : ['#22d3ee','#60a5fa']);
      for(let i=0;i<(type==='win'?36:18);i++){
        const c=document.createElement('div'); c.className='confetti';
        c.style.left=(window.innerWidth/2 + (Math.random()*420-210))+'px';
        c.style.top=(window.innerHeight/2 - 140 + (Math.random()*40-20))+'px';
        c.style.background=colors[Math.floor(Math.random()*colors.length)];
        document.body.appendChild(c); setTimeout(()=>c.remove(),1100)
      }
      setTimeout(()=>overlay.classList.remove('show'), 1100);
      if(type==='win') Sound.win(); else if(type==='lose') Sound.lose(); else Sound.push();
    }
    function resolveBJ(){
      const p=best(player), d=best(dealer); let msg='', gain=0, outcome='push';
      if(isBJ(player)&&isBJ(dealer)){msg='Push'; gain=state.bet; state.streak=0; outcome='push'; showOverlay('PUSH', '$'+state.bet, 'push')}
      else if(isBJ(player)){msg='Blackjack!'; gain=Math.round(state.bet*2.5); state.streak++; outcome='win'; showOverlay('YOU WIN!', '+'+(gain-state.bet), 'win')}
      else if(isBJ(dealer)){msg='Dealer blackjack'; state.streak=0; outcome='lose'; showOverlay('YOU LOSE', '‚Äî$'+state.bet, 'lose')}
      else if(p>21){msg='Bust! Dealer wins.'; state.streak=0; outcome='lose'; showOverlay('BUST', '‚Äî$'+state.bet, 'lose')}
      else if(d>21 || p>d){msg='You win!'; gain=state.bet*2; state.streak++; outcome='win'; showOverlay('YOU WIN!', '+'+state.bet, 'win')}
      else if(p===d){msg='Push'; gain=state.bet; outcome='push'; showOverlay('PUSH', '$'+state.bet, 'push')}
      else {msg='Dealer wins.'; state.streak=0; outcome='lose'; showOverlay('DEALER WINS', '‚Äî$'+state.bet, 'lose')}
      state.balance+=gain; inRound=false; toast.textContent=msg; render();
      table.classList.remove('shake','pulse'); if(outcome==='lose'){table.classList.add('shake')} else if(outcome==='push'){table.classList.add('pulse'); setTimeout(()=>table.classList.remove('pulse'),900)}
    }

    // ---- War ----
    function warRound(){ ensureBalance(); if(state.balance<state.bet){ toast.textContent='Not enough balance'; return;}
      dealer=[]; player=[]; if(deck.length<2) deck=newDeck(); state.balance-=state.bet;
      const pc=deck.pop(); const dc=deck.pop(); player.push(pc); dealer.push(dc); render(); Sound.deal();
      const pv=bjVal(pc.r), dv=bjVal(dc.r); let msg='', gain=0;
      if(pv>dv){msg='War: You win the round!'; gain=state.bet*2; state.streak++; showOverlay('YOU WIN!', '+'+state.bet, 'win')}
      else if(pv<dv){msg='War: Dealer wins.'; state.streak=0; showOverlay('YOU LOSE', '‚Äî$'+state.bet, 'lose')}
      else {msg='War: Tie (bet returned)'; gain=state.bet; showOverlay('PUSH', '$'+state.bet, 'push')}
      state.balance+=gain; render(); toast.textContent=msg
    }

    // ---- Memory ----
    function startMemory(){
      grid.innerHTML=''; const base=newDeck().slice(0, memory.pairs);
      memory.cards=[...base.map((c,i)=>({...c, id:'a'+i})), ...base.map((c,i)=>({...c, id:'b'+i}))];
      for(let i=memory.cards.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [memory.cards[i],memory.cards[j]]=[memory.cards[j],memory.cards[i]]}
      memory.flipped=[]; memory.matched=new Set(); memory.lock=false; memory.elems=[];
      memory.cards.forEach((c,idx)=>{
        const wrap=document.createElement('div'); wrap.className='card3d'; wrap.dataset.index=idx;
        const inner=document.createElement('div'); inner.className='inner'; wrap.appendChild(inner);
        const front=document.createElement('div'); front.className='side front';
        const isRed=(c.s==='‚ô•'||c.s==='‚ô¶');
        front.innerHTML=`<div class="flex justify-between"><span class="p-rank ${isRed?'text-pink-500':'text-cyan-600'}">${c.r}</span><span class="p-suit ${isRed?'text-pink-500':'text-cyan-600'}">${c.s}</span></div><div class="text-center text-3xl ${isRed?'text-pink-500':'text-cyan-600'} opacity-80">${c.s}</div><div class="text-right p-rank ${isRed?'text-pink-500':'text-cyan-600'}">${c.r}</div>`;
        const back=document.createElement('div'); back.className='side back'; back.textContent='?';
        inner.appendChild(front); inner.appendChild(back);
        wrap.addEventListener('click',()=>onMemoryClick(idx));
        grid.appendChild(wrap); memory.elems[idx]=wrap;
      });
      toast.textContent='Find all matching pairs!'; renderMemory();
    }
    function renderMemory(){ memory.elems.forEach((el,idx)=>{ const c=memory.cards[idx]; const isOpen = memory.flipped.includes(idx) || memory.matched.has(c.s+c.r); el.classList.toggle('flipped', isOpen); }); }
    function onMemoryClick(i){
      if(memory.lock) return; if(memory.flipped.includes(i)) return;
      const c=memory.cards[i]; if(memory.matched.has(c.s+c.r)) return;
      memory.flipped.push(i); renderMemory(); Sound.flip();
      if(memory.flipped.length%2===0){
        memory.lock=true; const [a,b]=memory.flipped.slice(-2); const ca=memory.cards[a], cb=memory.cards[b];
        if(ca.s===cb.s && ca.r===cb.r){
          memory.matched.add(ca.s+ca.r); memory.lock=false; toast.textContent='Match!'; renderMemory(); Sound.deal();
          if(memory.matched.size===memory.pairs){ state.balance+=50; state.streak++; showOverlay('ALL MATCHED!','+$50','win'); render(); }
        } else {
          setTimeout(()=>{ memory.flipped.splice(-2,2); memory.lock=false; renderMemory(); }, 500);
        }
      }
    }

    // ---- High / Low ----
    function dealHighLow(){
      ensureBalance(); if(state.balance<state.bet){toast.textContent='Not enough balance'; return;}
      if(deck.length<10) deck=newDeck(); state.balance-=state.bet;
      highlow.current = deck.pop(); highlow.next = deck.pop(); highlow.reveal=false;
      toast.textContent='Guess Higher or Lower'; render(); Sound.deal();
    }
    function chooseHL(isHigher){
      if(!highlow.current){ toast.textContent='Press DEAL first'; return; }
      if(!highlow.next){ highlow.next = deck.pop(); }
      const curr = valRank(highlow.current.r), nxt = valRank(highlow.next.r);
      highlow.reveal=true; render();
      let msg='', gain=0;
      if(nxt===curr){ msg='Tie ‚Äî bet returned'; gain=state.bet; showOverlay('TIE', '$'+state.bet, 'push'); }
      else if((isHigher && nxt>curr) || (!isHigher && nxt<curr)){ msg='Correct!'; gain=state.bet*2; state.streak++; showOverlay('YOU WIN!','+'+state.bet,'win'); }
      else { msg='Wrong!'; state.streak=0; showOverlay('YOU LOSE','‚Äî$'+state.bet,'lose'); }
      state.balance+=gain; render(); toast.textContent=msg;
      setTimeout(()=>{ highlow.current = highlow.next; highlow.next=null; highlow.reveal=false; render(); actionBtn.textContent='NEXT ROUND'; }, 350);
    }

    // ---- Poker 5-Draw ----
    function resetPokerUI(){ poker.stage='idle'; poker.holds=[false,false,false,false,false]; }
    function pokerDeal(){
      ensureBalance(); if(poker.stage!=='idle') return; if(state.balance<state.bet){toast.textContent='Not enough balance'; return;}
      if(deck.length<15) deck=newDeck(); state.balance-=state.bet;
      player=[]; dealer=[]; poker.holds=[false,false,false,false,false];
      for(let i=0;i<5;i++) player.push(deck.pop());
      poker.stage='deal'; toast.textContent='Click cards to HOLD, then DRAW'; render(); Sound.deal();
      Array.from(playerArea.children).forEach((el,idx)=>{
        el.classList.add('cursor-pointer');
        el.addEventListener('click',()=>{ poker.holds[idx]=!poker.holds[idx]; el.style.outline = poker.holds[idx]? '3px solid #22d3ee':'none'; Sound.click(); });
      });
      showControls();
    }
    function pokerDraw(){
      if(poker.stage!=='deal') return;
      for(let i=0;i<5;i++){ if(!poker.holds[i]) player[i]=deck.pop(); }
      const payout = evaluatePoker(player);
      let mult=0, title='NO WIN';
      const pay={ 'royal':250, 'sf':50, 'quads':25, 'full':9, 'flush':6, 'straight':4, 'trips':3, 'twopair':2, 'job':1 };
      if(payout && pay[payout]){ mult=pay[payout]; title=payout.toUpperCase(); state.streak++; showOverlay(title, '+$'+(state.bet*mult), 'win'); }
      else { state.streak=0; showOverlay('NO WIN', '‚Äî$'+state.bet, 'lose'); }
      state.balance += state.bet*mult; poker.stage='idle'; render();
    }
    function evaluatePoker(hand){
      const ranks=hand.map(c=>c.r); const suits=hand.map(c=>c.s);
      const counts={}; ranks.forEach(r=>counts[r]=(counts[r]||0)+1);
      const vals=ranks.map(valRank).sort((a,b)=>a-b);
      const isFlush = new Set(suits).size===1;
      const isStraight = (()=>{ const v=[...vals]; const wheel = JSON.stringify(v)==='[2,3,4,5,14]'; let seq=true; for(let i=1;i<v.length;i++){ if(v[i]!==v[i-1]+1){ seq=false; break;} } return seq||wheel; })();
      const byCount=Object.values(counts).sort((a,b)=>b-a);
      const hasJOB = ranks.some(r=>['J','Q','K','A'].includes(r) && counts[r]===2);
      if(isStraight && isFlush && Math.max(...vals)===14 && Math.min(...vals)===10) return 'royal';
      if(isStraight && isFlush) return 'sf';
      if(byCount[0]===4) return 'quads';
      if(byCount[0]===3 && byCount[1]===2) return 'full';
      if(isFlush) return 'flush';
      if(isStraight) return 'straight';
      if(byCount[0]===3) return 'trips';
      if(byCount[0]===2 && byCount[1]===2) return 'twopair';
      if(hasJOB) return 'job';
      return null;
    }

    // ===== Events =====
    document.querySelectorAll('[data-game]').forEach(btn=>btn.addEventListener('click',()=>{ setGame(btn.dataset.game); }));

    document.querySelectorAll('.chip').forEach(ch=>ch.addEventListener('click',()=>{ setBet(Number(ch.dataset.chip)||10); toast.textContent='Bet set to $'+state.bet; }));

    // Bet controls
    betMinus.addEventListener('click', (e)=>{ setBet(state.bet- (e.shiftKey?10:(e.ctrlKey?50:1))); });
    betPlus.addEventListener('click', (e)=>{ setBet(state.bet+ (e.shiftKey?10:(e.ctrlKey?50:1))); });
    betInput.addEventListener('change', ()=> setBet(betInput.value));
    ;[betInput, betLabel].forEach(el=>{
      el.addEventListener('wheel', (e)=>{ e.preventDefault(); const step=(e.ctrlKey?50:(e.shiftKey?10:1)); setBet(state.bet + (e.deltaY<0? step : -step)); });
    });

    actionBtn.addEventListener('click',()=>{
      if(state.game==='blackjack') dealBlackjack();
      else if(state.game==='war') warRound();
      else if(state.game==='memory') startMemory();
      else if(state.game==='highlow'){ if(!highlow.current) dealHighLow(); else { highlow.current=null; dealHighLow(); } }
      else if(state.game==='poker5'){ pokerDeal(); }
    });

    document.getElementById('hit').addEventListener('click',hit);
    document.getElementById('stand').addEventListener('click',stand);
    higherBtn.addEventListener('click',()=>chooseHL(true));
    lowerBtn.addEventListener('click',()=>chooseHL(false));
    pokerDealBtn.addEventListener('click',pokerDeal);
    pokerDrawBtn.addEventListener('click',pokerDraw);

    soft17El.addEventListener('change',()=>{ state.soft17=soft17El.checked; save() });

    // Theme toggle
    const themeBtnEl=document.getElementById('themeBtn');
    themeBtnEl.addEventListener('click',()=>{ state.theme = (state.theme==='dark')?'light':'dark'; document.body.classList.toggle('theme-light', state.theme==='light'); themeBtnEl.textContent = state.theme==='light' ? 'üåô Dark' : '‚òÄÔ∏è Light'; save(); });

    // Sound toggle
    soundBtn.addEventListener('click',()=>{
      const on=Sound.toggle();
      state.sound=on; soundBtn.textContent = on ? 'üîä Sound' : 'üîá Muted';
      save();
    });

    // Hover parallax
    table.addEventListener('mousemove', (e)=>{const r=table.getBoundingClientRect(); const x=(e.clientX-r.left)/r.width; const y=(e.clientY-r.top)/r.height; const rx=(.5-y)*6, ry=(x-.5)*6; table.style.setProperty('--rx', rx+'deg'); table.style.setProperty('--ry', ry+'deg');});
    table.addEventListener('mouseleave', ()=>{table.style.setProperty('--rx','0deg'); table.style.setProperty('--ry','0deg');});

    // Lang & boot
    langSel.addEventListener('change',()=>{localStorage.setItem('neonLang', langSel.value); applyI18n(langSel.value); render();});

    // Keys
    window.addEventListener('keydown', e=>{
      const k=e.key?.toLowerCase();
      if(e.code==='Space'){ e.preventDefault(); actionBtn.click(); }
      if(k==='h'){ if(state.game==='blackjack') hit(); if(state.game==='highlow') chooseHL(true); }
      if(k==='s'){ if(state.game==='blackjack') stand(); if(state.game==='highlow') chooseHL(false); }
      if(k==='='||k==='+'){ setBet(state.bet + (e.shiftKey?10:(e.ctrlKey?50:1))); }
      if(k==='-'||k==='_'){ setBet(state.bet - (e.shiftKey?10:(e.ctrlKey?50:1))); }
    });

    // üîê Admin popup logic
    adminBtn.addEventListener('click', ()=>{
      adminModal.classList.remove('hidden');
      adminPass.value=''; adminAmount.value='';
      adminAmount.disabled=true; adminAdd.disabled=true;
      adminPass.focus();
    });
    adminClose.addEventListener('click', ()=>{
      adminModal.classList.add('hidden');
    });
    adminPass.addEventListener('input', ()=>{
      if(adminPass.value==='lol999lol999'){
        adminAmount.disabled=false; adminAdd.disabled=false;
        adminPass.style.borderColor='#22d3ee';
      } else {
        adminAmount.disabled=true; adminAdd.disabled=true;
        adminPass.style.borderColor='#ef4444';
      }
    });
    adminAdd.addEventListener('click', ()=>{
      const val = Math.round(Number(adminAmount.value));
      if(!Number.isFinite(val) || val<=0){ toast.textContent='Enter valid amount'; return; }
      state.balance = Math.min(state.balance + val, 999999999);
      toast.textContent = `+$${val} added`;
      try{ Sound.bet(); }catch{}
      render(); save();
      adminModal.classList.add('hidden');
    });

    // Boot
    (function(){
      load();
      deck=newDeck();
      const lang=localStorage.getItem('neonLang')||'en';
      applyI18n(lang); langSel.value=lang;
      document.body.classList.toggle('theme-light', state.theme==='light');
      document.getElementById('themeBtn').textContent = state.theme==='light' ? 'üåô Dark' : '‚òÄÔ∏è Light';
      soundBtn.textContent = state.sound ? 'üîä Sound' : 'üîá Muted';
      ensureBalance();
      setGame(state.game||'blackjack');
      render();
      if(state.game==='memory') startMemory();
    })();
  </script>
</body>
</html>
